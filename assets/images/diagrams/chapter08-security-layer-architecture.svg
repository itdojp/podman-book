<svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      :root {
        --primary-color: #2563eb;
        --secondary-color: #10b981;
        --accent-color: #f59e0b;
        --error-color: #ef4444;
        --text-color: #1f2937;
        --bg-color: #ffffff;
        --border-color: #d1d5db;
        --surface-color: #f9fafb;
      }
      
      @media (prefers-color-scheme: dark) {
        :root {
          --primary-color: #3b82f6;
          --secondary-color: #34d399;
          --accent-color: #fbbf24;
          --error-color: #f87171;
          --text-color: #f9fafb;
          --bg-color: #111827;
          --border-color: #374151;
          --surface-color: #1f2937;
        }
      }
      
      .diagram {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        background: var(--bg-color);
      }
      
      .layer {
        fill: var(--surface-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
      }
      
      .application-layer {
        fill: var(--primary-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
        opacity: 0.8;
      }
      
      .runtime-layer {
        fill: var(--secondary-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
        opacity: 0.8;
      }
      
      .host-layer {
        fill: var(--accent-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
        opacity: 0.8;
      }
      
      .hardware-layer {
        fill: var(--error-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
        opacity: 0.6;
      }
      
      .security-feature {
        fill: var(--surface-color);
        stroke: var(--border-color);
        stroke-width: 1;
        rx: 4;
      }
      
      .text {
        fill: var(--text-color);
        font-size: 14px;
        font-weight: 500;
        text-anchor: middle;
        dominant-baseline: middle;
      }
      
      .title {
        fill: var(--text-color);
        font-size: 18px;
        font-weight: 600;
        text-anchor: middle;
      }
      
      .layer-title {
        fill: var(--bg-color);
        font-size: 16px;
        font-weight: 600;
        text-anchor: middle;
        dominant-baseline: middle;
      }
      
      .label {
        fill: var(--text-color);
        font-size: 12px;
        font-weight: 400;
        text-anchor: middle;
      }
      
      .small-text {
        fill: var(--text-color);
        font-size: 10px;
        font-weight: 400;
        text-anchor: middle;
      }
      
      .feature-text {
        fill: var(--text-color);
        font-size: 11px;
        font-weight: 500;
        text-anchor: middle;
        dominant-baseline: middle;
      }
      
      .arrow {
        stroke: var(--text-color);
        stroke-width: 3;
        fill: none;
        marker-end: url(#arrowhead);
      }
      
      .threat-arrow {
        stroke: var(--error-color);
        stroke-width: 2;
        fill: none;
        stroke-dasharray: 5,5;
        marker-end: url(#threatarrow);
      }
      
      @media (max-width: 480px) {
        .text { font-size: 12px; }
        .title { font-size: 16px; }
        .layer-title { font-size: 14px; }
        .label { font-size: 10px; }
        .small-text { font-size: 8px; }
        .feature-text { font-size: 9px; }
      }
    </style>
    
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="var(--text-color)" />
    </marker>
    
    <marker id="threatarrow" markerWidth="10" markerHeight="7" 
            refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="var(--error-color)" />
    </marker>
  </defs>
  
  <rect class="diagram" width="100%" height="100%" />
  
  <!-- Title -->
  <text x="400" y="30" class="title">Container Security Layer Architecture</text>
  
  <!-- Layer 1: Application Layer -->
  <rect class="application-layer" x="120" y="70" width="560" height="70" />
  <text x="400" y="95" class="layer-title">アプリケーション層</text>
  <text x="250" y="115" class="small-text">セキュアコーディング</text>
  <text x="400" y="115" class="small-text">依存関係管理</text>
  <text x="550" y="115" class="small-text">脆弱性スキャン</text>
  
  <!-- Security Features for Application Layer -->
  <rect class="security-feature" x="140" y="120" width="100" height="25" />
  <text x="190" y="132" class="feature-text">Input Validation</text>
  
  <rect class="security-feature" x="260" y="120" width="100" height="25" />
  <text x="310" y="132" class="feature-text">HTTPS/TLS</text>
  
  <rect class="security-feature" x="380" y="120" width="100" height="25" />
  <text x="430" y="132" class="feature-text">Auth/AuthZ</text>
  
  <rect class="security-feature" x="500" y="120" width="100" height="25" />
  <text x="550" y="132" class="feature-text">Logging</text>
  
  <!-- Layer 2: Container Runtime Layer -->
  <rect class="runtime-layer" x="100" y="170" width="600" height="70" />
  <text x="400" y="195" class="layer-title">コンテナランタイム層</text>
  <text x="200" y="215" class="small-text">Capabilities</text>
  <text x="300" y="215" class="small-text">Seccomp</text>
  <text x="400" y="215" class="small-text">SELinux</text>
  <text x="500" y="215" class="small-text">Rootless</text>
  <text x="600" y="215" class="small-text">Namespace</text>
  
  <!-- Security Features for Runtime Layer -->
  <rect class="security-feature" x="120" y="220" width="80" height="25" />
  <text x="160" y="232" class="feature-text">cgroups</text>
  
  <rect class="security-feature" x="220" y="220" width="80" height="25" />
  <text x="260" y="232" class="feature-text">AppArmor</text>
  
  <rect class="security-feature" x="320" y="220" width="80" height="25" />
  <text x="360" y="232" class="feature-text">No Daemon</text>
  
  <rect class="security-feature" x="420" y="220" width="80" height="25" />
  <text x="460" y="232" class="feature-text">User NS</text>
  
  <rect class="security-feature" x="520" y="220" width="80" height="25" />
  <text x="560" y="232" class="feature-text">Seccomp-BPF</text>
  
  <rect class="security-feature" x="620" y="220" width="80" height="25" />
  <text x="660" y="232" class="feature-text">Policy</text>
  
  <!-- Layer 3: Host OS Layer -->
  <rect class="host-layer" x="80" y="270" width="640" height="70" />
  <text x="400" y="295" class="layer-title">ホストOS層</text>
  <text x="200" y="315" class="small-text">カーネル強化</text>
  <text x="350" y="315" class="small-text">パッチ管理</text>
  <text x="500" y="315" class="small-text">ファイアウォール</text>
  <text x="620" y="315" class="small-text">監査ログ</text>
  
  <!-- Security Features for Host Layer -->
  <rect class="security-feature" x="100" y="320" width="100" height="25" />
  <text x="150" y="332" class="feature-text">Kernel Hardening</text>
  
  <rect class="security-feature" x="220" y="320" width="100" height="25" />
  <text x="270" y="332" class="feature-text">System Updates</text>
  
  <rect class="security-feature" x="340" y="320" width="100" height="25" />
  <text x="390" y="332" class="feature-text">Network Security</text>
  
  <rect class="security-feature" x="460" y="320" width="100" height="25" />
  <text x="510" y="332" class="feature-text">Access Control</text>
  
  <rect class="security-feature" x="580" y="320" width="100" height="25" />
  <text x="630" y="332" class="feature-text">Audit Trail</text>
  
  <!-- Layer 4: Hardware Layer -->
  <rect class="hardware-layer" x="60" y="370" width="680" height="70" />
  <text x="400" y="395" class="layer-title">ハードウェア層</text>
  <text x="200" y="415" class="small-text">セキュアブート</text>
  <text x="350" y="415" class="small-text">TPM</text>
  <text x="500" y="415" class="small-text">ハードウェア暗号化</text>
  <text x="620" y="415" class="small-text">物理セキュリティ</text>
  
  <!-- Security Features for Hardware Layer -->
  <rect class="security-feature" x="80" y="420" width="100" height="25" />
  <text x="130" y="432" class="feature-text">Secure Boot</text>
  
  <rect class="security-feature" x="200" y="420" width="100" height="25" />
  <text x="250" y="432" class="feature-text">TPM/HSM</text>
  
  <rect class="security-feature" x="320" y="420" width="100" height="25" />
  <text x="370" y="432" class="feature-text">HW Encryption</text>
  
  <rect class="security-feature" x="440" y="420" width="100" height="25" />
  <text x="490" y="432" class="feature-text">Memory Guard</text>
  
  <rect class="security-feature" x="560" y="420" width="100" height="25" />
  <text x="610" y="432" class="feature-text">Physical Access</text>
  
  <!-- Downward Flow Arrows -->
  <line class="arrow" x1="400" y1="140" x2="400" y2="170" />
  <line class="arrow" x1="400" y1="240" x2="400" y2="270" />
  <line class="arrow" x1="400" y1="340" x2="400" y2="370" />
  
  <!-- Threat Indicators -->
  <text x="50" y="120" class="small-text">脅威</text>
  <line class="threat-arrow" x1="30" y1="140" x2="70" y2="180" />
  <line class="threat-arrow" x1="30" y1="180" x2="70" y2="220" />
  <line class="threat-arrow" x1="30" y1="220" x2="50" y2="260" />
  <line class="threat-arrow" x1="30" y1="260" x2="50" y2="300" />
  
  <!-- Defense in Depth Benefits -->
  <text x="400" y="470" class="text">多層防御の利点</text>
  <text x="200" y="485" class="small-text">• 単一障害点の排除</text>
  <text x="400" y="485" class="small-text">• 攻撃面の最小化</text>
  <text x="600" y="485" class="small-text">• 段階的セキュリティ強化</text>
</svg>