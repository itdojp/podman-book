<svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      :root {
        --primary-color: #2563eb;
        --secondary-color: #10b981;
        --accent-color: #f59e0b;
        --text-color: #1f2937;
        --bg-color: #ffffff;
        --border-color: #d1d5db;
        --surface-color: #f9fafb;
      }
      
      @media (prefers-color-scheme: dark) {
        :root {
          --primary-color: #3b82f6;
          --secondary-color: #34d399;
          --accent-color: #fbbf24;
          --text-color: #f9fafb;
          --bg-color: #111827;
          --border-color: #374151;
          --surface-color: #1f2937;
        }
      }
      
      .diagram {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        background: var(--bg-color);
      }
      
      .layer {
        fill: var(--surface-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
      }
      
      .hardware-layer {
        fill: #6b7280;
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
        opacity: 0.8;
      }
      
      .kernel-layer {
        fill: var(--accent-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
        opacity: 0.8;
      }
      
      .runtime-layer {
        fill: var(--primary-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
        opacity: 0.8;
      }
      
      .container-layer {
        fill: var(--secondary-color);
        stroke: var(--border-color);
        stroke-width: 2;
        rx: 8;
        opacity: 0.8;
      }
      
      .security-feature {
        fill: var(--surface-color);
        stroke: var(--border-color);
        stroke-width: 1;
        rx: 4;
      }
      
      .text {
        fill: var(--text-color);
        font-size: 14px;
        font-weight: 500;
        text-anchor: middle;
        dominant-baseline: middle;
      }
      
      .title {
        fill: var(--text-color);
        font-size: 18px;
        font-weight: 600;
        text-anchor: middle;
      }
      
      .layer-title {
        fill: var(--bg-color);
        font-size: 16px;
        font-weight: 600;
        text-anchor: middle;
        dominant-baseline: middle;
      }
      
      .label {
        fill: var(--text-color);
        font-size: 12px;
        font-weight: 400;
        text-anchor: middle;
      }
      
      .small-text {
        fill: var(--text-color);
        font-size: 10px;
        font-weight: 400;
        text-anchor: middle;
      }
      
      .feature-text {
        fill: var(--text-color);
        font-size: 11px;
        font-weight: 500;
        text-anchor: middle;
        dominant-baseline: middle;
      }
      
      .threat {
        fill: #ef4444;
        stroke: var(--border-color);
        stroke-width: 1;
        rx: 4;
        opacity: 0.2;
      }
      
      .shield {
        stroke: var(--secondary-color);
        stroke-width: 2;
        fill: none;
        stroke-dasharray: 3,3;
      }
      
      @media (max-width: 480px) {
        .text { font-size: 12px; }
        .title { font-size: 16px; }
        .layer-title { font-size: 14px; }
        .label { font-size: 10px; }
        .small-text { font-size: 8px; }
        .feature-text { font-size: 9px; }
      }
    </style>
  </defs>
  
  <rect class="diagram" width="100%" height="100%" />
  
  <!-- Title -->
  <text x="400" y="30" class="title">Container Security Layers</text>
  
  <!-- Layer 1: Hardware/Physical -->
  <rect class="hardware-layer" x="60" y="470" width="680" height="80" />
  <text x="400" y="495" class="layer-title">Hardware & Physical Security</text>
  <text x="200" y="520" class="small-text">• Secure boot</text>
  <text x="200" y="535" class="small-text">• TPM/HSM</text>
  <text x="400" y="520" class="small-text">• Hardware isolation</text>
  <text x="400" y="535" class="small-text">• Memory protection</text>
  <text x="600" y="520" class="small-text">• CPU security features</text>
  <text x="600" y="535" class="small-text">• Virtualization support</text>
  
  <!-- Layer 2: Linux Kernel -->
  <rect class="kernel-layer" x="80" y="380" width="640" height="80" />
  <text x="400" y="405" class="layer-title">Linux Kernel Security</text>
  
  <!-- Kernel security features -->
  <rect class="security-feature" x="100" y="420" width="80" height="30" />
  <text x="140" y="435" class="feature-text">Namespaces</text>
  
  <rect class="security-feature" x="200" y="420" width="80" height="30" />
  <text x="240" y="435" class="feature-text">cgroups</text>
  
  <rect class="security-feature" x="300" y="420" width="80" height="30" />
  <text x="340" y="435" class="feature-text">Capabilities</text>
  
  <rect class="security-feature" x="400" y="420" width="80" height="30" />
  <text x="440" y="435" class="feature-text">Seccomp</text>
  
  <rect class="security-feature" x="500" y="420" width="80" height="30" />
  <text x="540" y="435" class="feature-text">SELinux</text>
  
  <rect class="security-feature" x="600" y="420" width="80" height="30" />
  <text x="640" y="435" class="feature-text">AppArmor</text>
  
  <!-- Layer 3: Container Runtime -->
  <rect class="runtime-layer" x="100" y="290" width="600" height="80" />
  <text x="400" y="315" class="layer-title">Container Runtime Security</text>
  
  <!-- Runtime security features -->
  <rect class="security-feature" x="120" y="330" width="90" height="30" />
  <text x="165" y="345" class="feature-text">Rootless Mode</text>
  
  <rect class="security-feature" x="230" y="330" width="90" height="30" />
  <text x="275" y="345" class="feature-text">User Mapping</text>
  
  <rect class="security-feature" x="340" y="330" width="90" height="30" />
  <text x="385" y="345" class="feature-text">No Daemon</text>
  
  <rect class="security-feature" x="450" y="330" width="90" height="30" />
  <text x="495" y="345" class="feature-text">Image Signing</text>
  
  <rect class="security-feature" x="560" y="330" width="90" height="30" />
  <text x="605" y="345" class="feature-text">Policy Engine</text>
  
  <!-- Layer 4: Container Environment -->
  <rect class="container-layer" x="120" y="200" width="560" height="80" />
  <text x="400" y="225" class="layer-title">Container Environment Security</text>
  
  <!-- Container security features -->
  <rect class="security-feature" x="140" y="240" width="90" height="30" />
  <text x="185" y="255" class="feature-text">Read-only FS</text>
  
  <rect class="security-feature" x="250" y="240" width="90" height="30" />
  <text x="295" y="255" class="feature-text">Non-root User</text>
  
  <rect class="security-feature" x="360" y="240" width="90" height="30" />
  <text x="405" y="255" class="feature-text">Minimal Image</text>
  
  <rect class="security-feature" x="470" y="240" width="90" height="30" />
  <text x="515" y="255" class="feature-text">Secret Mgmt</text>
  
  <rect class="security-feature" x="580" y="240" width="90" height="30" />
  <text x="625" y="255" class="feature-text">Health Checks</text>
  
  <!-- Layer 5: Application -->
  <rect class="layer" x="140" y="110" width="520" height="80" />
  <text x="400" y="135" class="text">Application Security</text>
  
  <!-- Application security features -->
  <rect class="security-feature" x="160" y="150" width="90" height="30" />
  <text x="205" y="165" class="feature-text">Input Validation</text>
  
  <rect class="security-feature" x="270" y="150" width="90" height="30" />
  <text x="315" y="165" class="feature-text">Crypto</text>
  
  <rect class="security-feature" x="380" y="150" width="90" height="30" />
  <text x="425" y="165" class="feature-text">Auth/AuthZ</text>
  
  <rect class="security-feature" x="490" y="150" width="90" height="30" />
  <text x="535" y="165" class="feature-text">Audit Logging</text>
  
  <rect class="security-feature" x="600" y="150" width="90" height="30" />
  <text x="645" y="165" class="feature-text">Secure Config</text>
  
  <!-- Threat vectors (left side) -->
  <text x="30" y="80" class="text">Threats</text>
  
  <rect class="threat" x="10" y="100" width="70" height="25" />
  <text x="45" y="112" class="small-text">Malware</text>
  
  <rect class="threat" x="10" y="140" width="70" height="25" />
  <text x="45" y="152" class="small-text">Code Injection</text>
  
  <rect class="threat" x="10" y="180" width="70" height="25" />
  <text x="45" y="192" class="small-text">Privilege Esc</text>
  
  <rect class="threat" x="10" y="220" width="70" height="25" />
  <text x="45" y="232" class="small-text">Data Breach</text>
  
  <rect class="threat" x="10" y="260" width="70" height="25" />
  <text x="45" y="272" class="small-text">DoS Attack</text>
  
  <rect class="threat" x="10" y="300" width="70" height="25" />
  <text x="45" y="312" class="small-text">Container Escape</text>
  
  <rect class="threat" x="10" y="340" width="70" height="25" />
  <text x="45" y="352" class="small-text">Host Compromise</text>
  
  <!-- Defense indicators -->
  <text x="770" y="80" class="text">Defense</text>
  <text x="770" y="100" class="small-text">Multiple</text>
  <text x="770" y="115" class="small-text">Layers</text>
  
  <!-- Shield lines showing protection -->
  <line class="shield" x1="80" y1="110" x2="720" y2="110" />
  <line class="shield" x1="100" y1="200" x2="720" y2="200" />
  <line class="shield" x1="120" y1="290" x2="720" y2="290" />
  <line class="shield" x1="140" y1="380" x2="720" y2="380" />
  <line class="shield" x1="160" y1="470" x2="720" y2="470" />
  
  <!-- Layer benefits -->
  <text x="400" y="570" class="text">Defense in Depth Benefits</text>
  <text x="200" y="590" class="small-text">• Redundant protection</text>
  <text x="400" y="590" class="small-text">• Reduced attack surface</text>
  <text x="600" y="590" class="small-text">• Fail-safe design</text>
</svg>