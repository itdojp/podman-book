<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <title>Pod共有名前空間アーキテクチャ</title>
  <desc>Pod内の共有名前空間とコンテナ間通信の詳細アーキテクチャ図</desc>
  <defs>
    <style>
      :root {
        --svg-bg: #ffffff;
        --svg-text: #1a1a1a;
        --svg-primary: #0066cc;
        --svg-success: #16a34a;
        --svg-warning: #ca8a04;
        --svg-error: #dc2626;
        --svg-neutral: #6b7280;
      }
      .title-text { font-family: Inter, 'Helvetica Neue', Arial, sans-serif; font-size: 16px; font-weight: 600; fill: var(--svg-text); }
      .pod-title { font-family: Inter, 'Helvetica Neue', Arial, sans-serif; font-size: 12px; font-weight: 500; fill: var(--svg-bg); }
      .namespace-text { font-family: Inter, 'Helvetica Neue', Arial, sans-serif; font-size: 12px; font-weight: 400; fill: var(--svg-text); }
      .annotation-text { font-family: Inter, 'Helvetica Neue', Arial, sans-serif; font-size: 10px; font-weight: 400; fill: var(--svg-neutral); }
      .pod-boundary { fill: var(--svg-primary); stroke: var(--svg-primary); stroke-width: 3; }
      .infra-container { fill: var(--svg-warning); stroke: var(--svg-warning); stroke-width: 2; }
      .app-container { fill: var(--svg-success); stroke: var(--svg-success); stroke-width: 2; }
      .shared-namespace { fill: var(--svg-neutral); stroke: var(--svg-neutral); stroke-width: 2; stroke-dasharray: 5,3; }
      .communication-line { stroke: var(--svg-primary); stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="var(--svg-primary)"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="40" class="title-text" text-anchor="middle">Pod共有名前空間アーキテクチャ</text>

  <!-- Pod Boundary -->
  <g id="pod-boundary">
    <rect x="60" y="70" width="680" height="480" class="pod-boundary" fill-opacity="0.1" rx="8"/>
    <text x="400" y="90" class="pod-title" text-anchor="middle">Pod: my-web-app</text>
  </g>

  <!-- Shared Namespaces -->
  <g id="shared-namespaces">
    <rect x="80" y="110" width="640" height="60" class="shared-namespace" fill-opacity="0.1" rx="4"/>
    <text x="400" y="130" class="namespace-text" text-anchor="middle" font-weight="500">共有名前空間</text>
    <text x="100" y="145" class="annotation-text">• Network Namespace</text>
    <text x="250" y="145" class="annotation-text">• IPC Namespace</text>
    <text x="400" y="145" class="annotation-text">• UTS Namespace</text>
    <text x="550" y="145" class="annotation-text">• Volume Mounts</text>
    <text x="100" y="160" class="annotation-text">• localhost通信</text>
    <text x="250" y="160" class="annotation-text">• 共有メモリ</text>
    <text x="400" y="160" class="annotation-text">• ホスト名共有</text>
    <text x="550" y="160" class="annotation-text">• データ共有</text>
  </g>

  <!-- Infrastructure Container -->
  <g id="infra-container">
    <rect x="100" y="190" width="200" height="120" class="infra-container" rx="4"/>
    <text x="200" y="210" class="pod-title" text-anchor="middle">インフラコンテナ</text>
    <text x="110" y="225" class="annotation-text">pause/k8s.gcr.io/pause</text>
    
    <!-- Infra Responsibilities -->
    <rect x="120" y="240" width="160" height="60" fill="var(--svg-bg)" stroke="var(--svg-warning)" stroke-width="1" rx="4"/>
    <text x="200" y="255" class="namespace-text" text-anchor="middle" font-weight="500">役割</text>
    <text x="130" y="270" class="annotation-text">• 名前空間の維持</text>
    <text x="130" y="285" class="annotation-text">• ネットワーク設定</text>
    <text x="130" y="295" class="annotation-text">• Pod ライフサイクル管理</text>
  </g>

  <!-- Application Containers -->
  <g id="app-containers">
    <!-- Web Container -->
    <rect x="320" y="190" width="180" height="120" class="app-container" rx="4"/>
    <text x="410" y="210" class="pod-title" text-anchor="middle">Webコンテナ</text>
    <text x="330" y="225" class="annotation-text">nginx:latest</text>
    
    <rect x="340" y="240" width="140" height="60" fill="var(--svg-bg)" stroke="var(--svg-success)" stroke-width="1" rx="4"/>
    <text x="410" y="255" class="namespace-text" text-anchor="middle" font-weight="500">機能</text>
    <text x="350" y="270" class="annotation-text">• HTTP サービス</text>
    <text x="350" y="285" class="annotation-text">• Port: 80, 443</text>
    <text x="350" y="295" class="annotation-text">• 静的ファイル配信</text>
    
    <!-- App Container -->
    <rect x="520" y="190" width="180" height="120" class="app-container" rx="4"/>
    <text x="610" y="210" class="pod-title" text-anchor="middle">アプリコンテナ</text>
    <text x="530" y="225" class="annotation-text">node:22-alpine</text>
    
    <rect x="540" y="240" width="140" height="60" fill="var(--svg-bg)" stroke="var(--svg-success)" stroke-width="1" rx="4"/>
    <text x="610" y="255" class="namespace-text" text-anchor="middle" font-weight="500">機能</text>
    <text x="550" y="270" class="annotation-text">• API サービス</text>
    <text x="550" y="285" class="annotation-text">• Port: 3000</text>
    <text x="550" y="295" class="annotation-text">• ビジネスロジック</text>
  </g>

  <!-- Shared Volumes -->
  <g id="shared-volumes">
    <rect x="100" y="330" width="600" height="100" fill="var(--svg-neutral)" fill-opacity="0.1" stroke="var(--svg-neutral)" stroke-width="2" rx="4"/>
    <text x="400" y="350" class="namespace-text" text-anchor="middle" font-weight="500">共有ボリューム</text>
    
    <!-- Config Volume -->
    <rect x="120" y="360" width="150" height="60" fill="var(--svg-bg)" stroke="var(--svg-neutral)" stroke-width="1" rx="4"/>
    <text x="195" y="380" class="namespace-text" text-anchor="middle" font-weight="500">設定ボリューム</text>
    <text x="130" y="395" class="annotation-text">• /etc/config</text>
    <text x="130" y="410" class="annotation-text">• 設定ファイル共有</text>
    
    <!-- Log Volume -->
    <rect x="290" y="360" width="150" height="60" fill="var(--svg-bg)" stroke="var(--svg-neutral)" stroke-width="1" rx="4"/>
    <text x="365" y="380" class="namespace-text" text-anchor="middle" font-weight="500">ログボリューム</text>
    <text x="300" y="395" class="annotation-text">• /var/log</text>
    <text x="300" y="410" class="annotation-text">• ログファイル共有</text>
    
    <!-- Data Volume -->
    <rect x="460" y="360" width="150" height="60" fill="var(--svg-bg)" stroke="var(--svg-neutral)" stroke-width="1" rx="4"/>
    <text x="535" y="380" class="namespace-text" text-anchor="middle" font-weight="500">データボリューム</text>
    <text x="470" y="395" class="annotation-text">• /app/data</text>
    <text x="470" y="410" class="annotation-text">• アプリデータ</text>
  </g>

  <!-- Communication Patterns -->
  <g id="communication">
    <rect x="120" y="450" width="560" height="80" fill="var(--svg-primary)" fill-opacity="0.05" stroke="var(--svg-primary)" stroke-width="2" rx="4"/>
    <text x="400" y="470" class="namespace-text" text-anchor="middle" font-weight="500">Pod内通信パターン</text>
    
    <!-- Localhost Communication -->
    <text x="140" y="485" class="annotation-text" font-weight="500">localhost通信:</text>
    <text x="230" y="485" class="annotation-text">nginx → http://localhost:3000 (Node.js API)</text>
    
    <!-- IPC Communication -->
    <text x="140" y="500" class="annotation-text" font-weight="500">IPC通信:</text>
    <text x="195" y="500" class="annotation-text">共有メモリ、Unix Domain Socket</text>
    
    <!-- Volume Communication -->
    <text x="140" y="515" class="annotation-text" font-weight="500">ファイル通信:</text>
    <text x="220" y="515" class="annotation-text">共有ボリュームでのファイル交換</text>
  </g>

  <!-- Communication Lines -->
  <path d="M 300 250 L 320 250" class="communication-line"/>
  <path d="M 500 250 L 520 250" class="communication-line"/>
  
  <!-- Volume Access Lines -->
  <path d="M 200 310 L 195 360" stroke="var(--svg-neutral)" stroke-width="1" stroke-dasharray="3,3" fill="none"/>
  <path d="M 410 310 L 365 360" stroke="var(--svg-neutral)" stroke-width="1" stroke-dasharray="3,3" fill="none"/>
  <path d="M 610 310 L 535 360" stroke="var(--svg-neutral)" stroke-width="1" stroke-dasharray="3,3" fill="none"/>

  <!-- Benefits -->
  <g id="benefits">
    <rect x="120" y="540" width="560" height="20" fill="var(--svg-success)" fill-opacity="0.1" stroke="var(--svg-success)" stroke-width="2" rx="4"/>
    <text x="400" y="555" class="annotation-text" text-anchor="middle" font-weight="500">利点: 緊密結合、高速通信、リソース共有、統合デプロイ</text>
  </g>
</svg>
